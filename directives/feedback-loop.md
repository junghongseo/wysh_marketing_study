# SOP: 피드백 루프 (Feedback Loop)

> **버전**: v1.0  
> **역할**: 이전 주차의 마케팅 액션 실행 결과를 평가하고, 다음 주차 전략에 반영하는 절차  
> **적용 시점**: Week 2부터 (Week 1은 피드백 대상이 없으므로 스킵)

---

## 목적

마케팅은 "실행 → 측정 → 학습 → 개선"의 반복이다. 이 SOP는 직전 주에 제안된 아이디어의 실행 여부와 성과를 평가하고, 그 학습을 다음 주 아이디어 생성에 반영하는 메커니즘을 정의한다.

---

## 사전 조건

- [ ] 직전 주차(Week N-1)의 `ideas.json`이 존재함
- [ ] WYSH 쇼핑몰/인스타그램에서 변화를 관찰할 수 있음

---

## 실행 절차

### Step 1: 이전 주차 아이디어 로드

```
입력: data/weeks/week-(N-1)/ideas.json
```

직전 주에 제안된 모든 아이디어를 로드하고, 각각에 대해 실행 여부를 확인한다.

### Step 2: 실행 결과 확인

**자동 확인 (에이전트가 수행)**:
1. WYSH 쇼핑몰 스캔 → 제품 페이지/프로모션 변화 확인
2. Instagram 피드 스캔 → 새로운 게시물/리얼스 확인
3. 이전 주와 이번 주의 `wysh-context.json` 비교

**수동 확인 (사용자에게 질의)**:
에이전트는 아래 질문을 사용자에게 한다:
- "지난 주 제안된 아이디어 중 실행한 것이 있나요?"
- "실행한 아이디어의 결과(반응, 수치 등)는 어떠했나요?"
- "실행하지 않은 아이디어가 있다면, 이유는 무엇인가요?"

### Step 3: 피드백 데이터 생성

확인된 결과를 아래 형식으로 정리하여 저장한다:

```json
{
  "week": 2,
  "feedback_for_week": 1,
  "generated_at": "2026-02-21T10:00:00+09:00",
  "source": "auto+manual",
  "idea_outcomes": [
    {
      "idea_id": 1,
      "idea_title": "아이디어 제목",
      "executed": true,
      "outcome": "실행 결과 설명",
      "metrics": {
        "engagement_change": "+15%",
        "notes": "인스타그램 릴스 조회수 1.2K"
      },
      "learnings": "이 접근이 효과적이었던 이유 또는 실패 원인"
    },
    {
      "idea_id": 2,
      "idea_title": "실행하지 않은 아이디어",
      "executed": false,
      "reason_not_executed": "시간 부족 / 우선순위 밀림",
      "carry_forward": true
    }
  ],
  "overall_assessment": "이번 주 전체 평가 요약",
  "adjustments_for_next_week": [
    "다음 주에 반영할 조정 사항 1",
    "다음 주에 반영할 조정 사항 2"
  ]
}
```

**저장 경로**: `data/weeks/week-XX/feedback.json` (현재 주차 디렉토리에 저장)

### Step 4: 다음 주차 전략 반영

피드백 데이터를 기반으로, `idea-generation.md` SOP 실행 시 다음을 추가 고려한다:

| 피드백 유형 | 반영 방법 |
|------------|-----------|
| 실행 + 성공 | 유사 아이디어를 확장/심화하여 제안 |
| 실행 + 실패 | 원인 분석 후 다른 접근법 제안 |
| 미실행 (시간 부족) | 더 작은 규모로 재제안 (Smallest 강화) |
| 미실행 (적합하지 않음) | 해당 카테고리 아이디어 비중 축소 |
| carry_forward | 우선순위를 높여 다시 제안 |

### Step 5: WYSH 컨텍스트 변화 감지

이전 주와 이번 주의 `wysh-context.json`을 비교하여:
- 새로운 제품이 추가되었는가?
- 프로모션이 변경되었는가?
- 인스타그램 게시 빈도나 톤이 변했는가?

변화가 있다면, 이를 `adjustments_for_next_week`에 반영한다.

---

## 피드백 축적 메커니즘

시간이 지날수록 축적된 피드백은 점점 더 정교한 아이디어를 만들어낸다:

```
Week 1: 기본 아이디어 (챕터 원칙 + 브랜드 컨텍스트)
Week 2: 기본 + Week 1 피드백 반영
Week 3: 기본 + Week 1~2 피드백 + 트렌드 변화
...
Week N: 기본 + 축적된 N-1주의 학습 + 시장 변화
```

에이전트는 최근 3주의 `feedback.json`을 로드하여 패턴을 식별한다:
- **반복 성공 패턴**: "콘텐츠 카테고리 아이디어가 3주 연속 성공 → 콘텐츠 비중 확대"
- **반복 실패 패턴**: "전환 카테고리 아이디어가 2주 연속 미실행 → 실행 난이도 낮추기"

---

## 출력 체크리스트

- [ ] `feedback.json` 저장 완료
- [ ] 이전 주 아이디어 각각에 대한 outcome 기록 완료
- [ ] `adjustments_for_next_week` 2개 이상 도출
- [ ] 에이전트가 `complete-step feedback_applied` 실행
